// Code generated by goa v3.24.1, DO NOT EDIT.
//
// ingest HTTP client types
//
// Command:
// $ goa gen github.com/aditnikel/grapgraph/design

package client

import (
	ingest "github.com/aditnikel/grapgraph/gen/ingest"
	goa "goa.design/goa/v3/pkg"
)

// PostEventRequestBody is the type of the "ingest" service "post_event"
// endpoint HTTP request body.
type PostEventRequestBody struct {
	// List of events to ingest in-order.
	Events []*CustomerEventRequestBody `form:"events" json:"events" xml:"events"`
}

// PostEventResponseBody is the type of the "ingest" service "post_event"
// endpoint HTTP response body.
type PostEventResponseBody struct {
	// Whether all events were processed successfully.
	Accepted *bool `form:"accepted,omitempty" json:"accepted,omitempty" xml:"accepted,omitempty"`
	// Number of events accepted in this batch.
	AcceptedCount *int `form:"accepted_count,omitempty" json:"accepted_count,omitempty" xml:"accepted_count,omitempty"`
	// Number of events rejected in this batch.
	FailedCount *int `form:"failed_count,omitempty" json:"failed_count,omitempty" xml:"failed_count,omitempty"`
}

// CustomerEventRequestBody is used to define fields on request body types.
type CustomerEventRequestBody struct {
	// Unique identifier of the user (e.g. u_123).
	UserID string `form:"user_id" json:"user_id" xml:"user_id"`
	// Target merchant ID or card MPAN.
	MerchantIDMpan *string `form:"merchant_id_mpan,omitempty" json:"merchant_id_mpan,omitempty" xml:"merchant_id_mpan,omitempty"`
	// The type of event (PAYMENT, LOGIN, WITHDRAWAL, etc).
	EventType string `form:"event_type" json:"event_type" xml:"event_type"`
	// Timestamp of the activity (RFC3339 string or Epoch MS).
	EventTimestamp any `form:"event_timestamp" json:"event_timestamp" xml:"event_timestamp"`
	// Monetary value of the transaction.
	TotalTransactionAmount *float64 `form:"total_transaction_amount,omitempty" json:"total_transaction_amount,omitempty" xml:"total_transaction_amount,omitempty"`
	// Unique hardware ID where the activity originated.
	DeviceID *string `form:"device_id,omitempty" json:"device_id,omitempty" xml:"device_id,omitempty"`
	// Method used (VISA, CRYPTO, etc).
	PaymentMethod *string `form:"payment_method,omitempty" json:"payment_method,omitempty" xml:"payment_method,omitempty"`
	// The bank that issued the instrument.
	IssuingBank *string `form:"issuing_bank,omitempty" json:"issuing_bank,omitempty" xml:"issuing_bank,omitempty"`
	// Blockchain wallet address if applicable.
	WalletAddress *string `form:"wallet_address,omitempty" json:"wallet_address,omitempty" xml:"wallet_address,omitempty"`
	// Crypto exchange name if applicable.
	Exchange *string `form:"exchange,omitempty" json:"exchange,omitempty" xml:"exchange,omitempty"`
	// Remote IP address (not stored directly in graph).
	IPAddress *string `form:"ip_address,omitempty" json:"ip_address,omitempty" xml:"ip_address,omitempty"`
}

// NewPostEventRequestBody builds the HTTP request body from the payload of the
// "post_event" endpoint of the "ingest" service.
func NewPostEventRequestBody(p *ingest.BulkCustomerEvents) *PostEventRequestBody {
	body := &PostEventRequestBody{}
	if p.Events != nil {
		body.Events = make([]*CustomerEventRequestBody, len(p.Events))
		for i, val := range p.Events {
			if val == nil {
				body.Events[i] = nil
				continue
			}
			body.Events[i] = marshalIngestCustomerEventToCustomerEventRequestBody(val)
		}
	} else {
		body.Events = []*CustomerEventRequestBody{}
	}
	return body
}

// NewPostEventBulkIngestResponseAccepted builds a "ingest" service
// "post_event" endpoint result from a HTTP "Accepted" response.
func NewPostEventBulkIngestResponseAccepted(body *PostEventResponseBody) *ingest.BulkIngestResponse {
	v := &ingest.BulkIngestResponse{
		Accepted:      *body.Accepted,
		AcceptedCount: *body.AcceptedCount,
		FailedCount:   *body.FailedCount,
	}

	return v
}

// NewPostEventBadRequest builds a ingest service post_event endpoint
// bad_request error.
func NewPostEventBadRequest(body string) ingest.BadRequest {
	v := ingest.BadRequest(body)

	return v
}

// ValidatePostEventResponseBody runs the validations defined on
// post_event_response_body
func ValidatePostEventResponseBody(body *PostEventResponseBody) (err error) {
	if body.Accepted == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("accepted", "body"))
	}
	if body.AcceptedCount == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("accepted_count", "body"))
	}
	if body.FailedCount == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("failed_count", "body"))
	}
	return
}

// ValidateCustomerEventRequestBody runs the validations defined on
// CustomerEventRequestBody
func ValidateCustomerEventRequestBody(body *CustomerEventRequestBody) (err error) {
	if body.EventTimestamp == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("event_timestamp", "body"))
	}
	return
}

// Code generated by goa v3.24.1, DO NOT EDIT.
//
// ingest HTTP client CLI support package
//
// Command:
// $ goa gen github.com/aditnikel/grapgraph/design

package client

import (
	"encoding/json"
	"fmt"

	ingest "github.com/aditnikel/grapgraph/gen/ingest"
	goa "goa.design/goa/v3/pkg"
)

// BuildPostEventPayload builds the payload for the ingest post_event endpoint
// from CLI flags.
func BuildPostEventPayload(ingestPostEventBody string) (*ingest.CustomerEvent, error) {
	var err error
	var body PostEventRequestBody
	{
		err = json.Unmarshal([]byte(ingestPostEventBody), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"device_id\": \"d_888\",\n      \"event_timestamp\": \"2024-03-20T10:00:00Z\",\n      \"event_type\": \"PAYMENT\",\n      \"exchange\": \"BINANCE\",\n      \"ip_address\": \"192.168.1.1\",\n      \"issuing_bank\": \"JP_MORGAN\",\n      \"merchant_id_mpan\": \"m_777\",\n      \"payment_method\": \"VISA\",\n      \"total_transaction_amount\": 150.5,\n      \"user_id\": \"u_123\",\n      \"wallet_address\": \"0xabc123\"\n   }'")
		}
		if body.EventTimestamp == nil {
			err = goa.MergeErrors(err, goa.MissingFieldError("event_timestamp", "body"))
		}
		if err != nil {
			return nil, err
		}
	}
	v := &ingest.CustomerEvent{
		UserID:                 body.UserID,
		MerchantIDMpan:         body.MerchantIDMpan,
		EventType:              body.EventType,
		EventTimestamp:         body.EventTimestamp,
		TotalTransactionAmount: body.TotalTransactionAmount,
		DeviceID:               body.DeviceID,
		PaymentMethod:          body.PaymentMethod,
		IssuingBank:            body.IssuingBank,
		WalletAddress:          body.WalletAddress,
		Exchange:               body.Exchange,
		IPAddress:              body.IPAddress,
	}

	return v, nil
}

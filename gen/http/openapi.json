{"swagger":"2.0","info":{"title":"Grapgraph API","description":"High-performance fraud detection and financial network analysis platform built with Goa and FalkorDB.","version":"0.0.1"},"host":"localhost:8080","consumes":["application/json","application/xml","application/gob"],"produces":["application/json","application/xml","application/gob"],"paths":{"/":{"get":{"tags":["openapi"],"summary":"index openapi","description":"Provides a simple landing page.","operationId":"openapi#index","responses":{"200":{"description":"OK response.","schema":{"type":"string"}}},"schemes":["http"]}},"/docs":{"get":{"tags":["openapi"],"summary":"docs openapi","description":"Serves the interactive Swagger UI.","operationId":"openapi#docs","produces":["text/html"],"responses":{"200":{"description":"OK response.","schema":{"type":"string"}}},"schemes":["http"]}},"/healthz":{"get":{"tags":["health"],"summary":"get health","description":"Returns the health status of the API and its underlying graph database.","operationId":"health#get","responses":{"200":{"description":"OK response.","schema":{"$ref":"#/definitions/HealthResponse","required":["ok"]}},"503":{"description":"Service Unavailable response.","schema":{"$ref":"#/definitions/HealthResponse","required":["ok"]}}},"schemes":["http"]}},"/openapi.json":{"get":{"tags":["openapi"],"summary":"Download gen/http/openapi3.json","operationId":"openapi#/openapi.json","responses":{"200":{"description":"File downloaded","schema":{"type":"file"}}},"schemes":["http"]}},"/v1/graph/edge":{"post":{"tags":["graph"],"summary":"post_manual_edge graph","description":"Creates a manual relationship between two nodes.","operationId":"graph#post_manual_edge","parameters":[{"name":"post_manual_edge_request_body","in":"body","required":true,"schema":{"$ref":"#/definitions/ManualEdgeRequest","required":["from","to","edge_type"]}}],"responses":{"201":{"description":"Created response.","schema":{"$ref":"#/definitions/GraphEdge","required":["id","type","from","to","directed","manual"]}},"400":{"description":"Bad Request response.","schema":{"type":"string"}}},"schemes":["http"]}},"/v1/graph/metadata":{"get":{"tags":["graph"],"summary":"get_metadata graph","description":"Returns valid node types, edge types, and supported ranking metrics.","operationId":"graph#get_metadata","responses":{"200":{"description":"OK response.","schema":{"$ref":"#/definitions/MetadataResponse","required":["node_types","edge_types"]}}},"schemes":["http"]}},"/v1/graph/subgraph":{"post":{"tags":["graph"],"summary":"post_subgraph graph","description":"Extracts a surrounding subgraph for a specific root node using multi-hop analysis.","operationId":"graph#post_subgraph","parameters":[{"name":"post_subgraph_request_body","in":"body","required":true,"schema":{"$ref":"#/definitions/SubgraphRequest","required":["root","limit"]}}],"responses":{"200":{"description":"OK response.","schema":{"$ref":"#/definitions/SubgraphResponse","required":["version","root","nodes","edges","truncated"]}},"400":{"description":"Bad Request response.","schema":{"type":"string"}}},"schemes":["http"]}},"/v1/ingest/event":{"post":{"tags":["ingest"],"summary":"post_event ingest","description":"Accepts one or more financial events (Payment, Login, etc.) and updates the relationship graph.","operationId":"ingest#post_event","parameters":[{"name":"post_event_request_body","in":"body","required":true,"schema":{"$ref":"#/definitions/BulkCustomerEvents","required":["events"]}}],"responses":{"202":{"description":"Accepted response.","schema":{"$ref":"#/definitions/BulkIngestResponse","required":["accepted","accepted_count","failed_count"]}},"400":{"description":"Bad Request response.","schema":{"type":"string"}}},"schemes":["http"]}}},"definitions":{"BulkCustomerEvents":{"title":"BulkCustomerEvents","type":"object","properties":{"events":{"type":"array","items":{"$ref":"#/definitions/CustomerEvent"},"description":"List of events to ingest in-order.","example":[{"event_timestamp":"2024-03-20T10:00:00Z","event_type":"PAYMENT","merchant_id_mpan":"m_7","total_transaction_amount":125,"user_id":"u_1"},{"event_timestamp":1710930030000,"event_type":"LOGIN","user_id":"u_2"}],"minItems":1}},"example":{"events":[{"event_timestamp":"2024-03-20T10:00:00Z","event_type":"PAYMENT","merchant_id_mpan":"m_7","total_transaction_amount":125,"user_id":"u_1"},{"event_timestamp":1710930030000,"event_type":"LOGIN","user_id":"u_2"}]},"required":["events"]},"BulkIngestResponse":{"title":"BulkIngestResponse","type":"object","properties":{"accepted":{"type":"boolean","description":"Whether all events were processed successfully.","example":true},"accepted_count":{"type":"integer","description":"Number of events accepted in this batch.","example":3,"format":"int64"},"failed_count":{"type":"integer","description":"Number of events rejected in this batch.","example":0,"format":"int64"}},"example":{"accepted":true,"accepted_count":3,"failed_count":0},"required":["accepted","accepted_count","failed_count"]},"CustomerEvent":{"title":"CustomerEvent","type":"object","properties":{"device_id":{"type":"string","description":"Unique hardware ID where the activity originated.","example":"d_888"},"event_timestamp":{"description":"Timestamp of the activity (RFC3339 string or Epoch MS).","example":"2024-03-20T10:00:00Z"},"event_type":{"type":"string","description":"The type of event (PAYMENT, LOGIN, WITHDRAWAL, etc).","example":"PAYMENT"},"exchange":{"type":"string","description":"Crypto exchange name if applicable.","example":"BINANCE"},"ip_address":{"type":"string","description":"Remote IP address (not stored directly in graph).","example":"192.168.1.1"},"issuing_bank":{"type":"string","description":"The bank that issued the instrument.","example":"JP_MORGAN"},"merchant_id_mpan":{"type":"string","description":"Target merchant ID or card MPAN.","example":"m_777"},"payment_method":{"type":"string","description":"Method used (VISA, CRYPTO, etc).","example":"VISA"},"total_transaction_amount":{"type":"number","description":"Monetary value of the transaction.","example":150.5,"format":"double"},"user_id":{"type":"string","description":"Unique identifier of the user (e.g. u_123).","example":"u_123"},"wallet_address":{"type":"string","description":"Blockchain wallet address if applicable.","example":"0xabc123"}},"description":"Information about a financial activity or user action.","example":{"device_id":"d_888","event_timestamp":"2024-03-20T10:00:00Z","event_type":"PAYMENT","exchange":"BINANCE","ip_address":"192.168.1.1","issuing_bank":"JP_MORGAN","merchant_id_mpan":"m_777","payment_method":"VISA","total_transaction_amount":150.5,"user_id":"u_123","wallet_address":"0xabc123"},"required":["user_id","event_type","event_timestamp"]},"GraphEdge":{"title":"GraphEdge","type":"object","properties":{"directed":{"type":"boolean","description":"Whether the relationship has a specific flow direction.","example":true},"from":{"type":"string","description":"ID of the source node.","example":"USER:u_123"},"id":{"type":"string","description":"Unique ID for the specific relationship.","example":"e123"},"manual":{"type":"boolean","description":"Whether the relationship was manually added.","example":false},"to":{"type":"string","description":"ID of the target node.","example":"MERCHANT:m_777"},"type":{"type":"string","description":"The type of connection (e.g. PAYMENT).","example":"PAYMENT"}},"description":"A relationship between two entities.","example":{"directed":true,"from":"USER:u_123","id":"e123","manual":false,"to":"MERCHANT:m_777","type":"PAYMENT"},"required":["id","type","from","to","directed","manual"]},"GraphNode":{"title":"GraphNode","type":"object","properties":{"id":{"type":"string","description":"Stable ID generated for visualization.","example":"USER:u_123"},"key":{"type":"string","description":"The domain-specific key (e.g. u_123).","example":"u_123"},"label":{"type":"string","description":"Human-friendly display name.","example":"User u_123"},"props":{"type":"object","description":"Additional key-value properties.","example":{"Accusantium repellat dolores quae.":"Ratione dolor natus dolor maiores magnam.","Fugiat rerum iste sapiente ipsam.":"Autem quasi deserunt magni rerum labore.","Sed esse doloremque.":"Enim est unde qui voluptatibus."},"additionalProperties":true},"type":{"type":"string","description":"The category of the entity.","example":"USER"}},"description":"A single entity (User, Merchant, Device) in the resulting subgraph.","example":{"id":"USER:u_123","key":"u_123","label":"User u_123","props":{"Reiciendis dolores repudiandae earum.":"Repellendus odio quos modi nisi."},"type":"USER"},"required":["id","type","key","label"]},"HealthResponse":{"title":"HealthResponse","type":"object","properties":{"error":{"type":"string","description":"Error message if the service is unhealthy.","example":"Database connection failed"},"ok":{"type":"boolean","description":"Whether the service is fully operational.","example":true}},"example":{"error":"Database connection failed","ok":true},"required":["ok"]},"ManualEdgeRequest":{"title":"ManualEdgeRequest","type":"object","properties":{"edge_type":{"type":"string","description":"Relationship type (e.g. PAYMENT, MANUAL).","example":"MANUAL"},"from":{"$ref":"#/definitions/NodeRef"},"to":{"$ref":"#/definitions/NodeRef"}},"example":{"edge_type":"MANUAL","from":{"key":"u_123","type":"USER"},"to":{"key":"u_123","type":"USER"}},"required":["from","to","edge_type"]},"MetadataResponse":{"title":"MetadataResponse","type":"object","properties":{"edge_types":{"type":"array","items":{"type":"string","example":"Eos exercitationem tempore aspernatur dolorem vel."},"description":"All valid event types.","example":["PAYMENT","LOGIN","WITHDRAWAL"]},"node_types":{"type":"array","items":{"type":"string","example":"Assumenda excepturi."},"description":"All valid entity types.","example":["USER","MERCHANT","DEVICE"]}},"example":{"edge_types":["PAYMENT","LOGIN","WITHDRAWAL"],"node_types":["USER","MERCHANT","DEVICE"]},"required":["node_types","edge_types"]},"NodeRef":{"title":"NodeRef","type":"object","properties":{"key":{"type":"string","description":"The unique key of the node.","example":"u_123"},"type":{"type":"string","description":"Type of the node.","example":"USER"}},"description":"A reference to a specific node in the graph.","example":{"key":"u_123","type":"USER"},"required":["type","key"]},"SubgraphRequest":{"title":"SubgraphRequest","type":"object","properties":{"edge_types":{"type":"array","items":{"type":"string","example":"Iusto quasi."},"description":"Filter to only include these relationship types.","example":["PAYMENT","LOGIN"]},"hops":{"type":"integer","description":"Number of hops to traverse (\u003e=1).","default":2,"example":2,"format":"int64","minimum":1},"limit":{"type":"object","properties":{"max_edges":{"type":"integer","description":"Maximum number of edges to return.","default":200,"example":100,"format":"int64"},"max_nodes":{"type":"integer","description":"Maximum number of nodes to return.","default":100,"example":50,"format":"int64"}},"description":"Resource budget for the response.","example":{"max_edges":100,"max_nodes":50},"required":["max_nodes","max_edges"]},"min_event_count":{"type":"integer","description":"Only include edges with at least this event_count. Set to 0 to disable.","default":0,"example":2,"format":"int64","minimum":0},"root":{"type":"object","properties":{"key":{"type":"string","description":"The unique key of the root node.","example":"u_123"},"type":{"type":"string","description":"Type of the root node (usually USER).","example":"USER"}},"description":"The starting node for the traversal.","example":{"key":"u_123","type":"USER"},"required":["type","key"]},"time_window_ms":{"type":"integer","description":"Only include edges observed within the last N milliseconds. Omit or set to 0 for all time.","default":0,"example":2592000000,"format":"int64","minimum":0}},"example":{"edge_types":["PAYMENT","LOGIN"],"hops":2,"limit":{"max_edges":100,"max_nodes":50},"min_event_count":2,"root":{"key":"u_123","type":"USER"},"time_window_ms":2592000000},"required":["root","limit"]},"SubgraphResponse":{"title":"SubgraphResponse","type":"object","properties":{"edges":{"type":"array","items":{"$ref":"#/definitions/GraphEdge"},"description":"List of all connections found.","example":[{"directed":true,"from":"USER:u_123","id":"e123","manual":false,"to":"MERCHANT:m_777","type":"PAYMENT"},{"directed":true,"from":"USER:u_123","id":"e123","manual":false,"to":"MERCHANT:m_777","type":"PAYMENT"},{"directed":true,"from":"USER:u_123","id":"e123","manual":false,"to":"MERCHANT:m_777","type":"PAYMENT"}]},"nodes":{"type":"array","items":{"$ref":"#/definitions/GraphNode"},"description":"List of all entities in the network.","example":[{"id":"USER:u_123","key":"u_123","label":"User u_123","props":{"Fugit quibusdam quod perferendis expedita pariatur quia.":"Sapiente aut odio laudantium ut et nulla.","Voluptatem corrupti voluptas.":"Qui delectus."},"type":"USER"},{"id":"USER:u_123","key":"u_123","label":"User u_123","props":{"Fugit quibusdam quod perferendis expedita pariatur quia.":"Sapiente aut odio laudantium ut et nulla.","Voluptatem corrupti voluptas.":"Qui delectus."},"type":"USER"},{"id":"USER:u_123","key":"u_123","label":"User u_123","props":{"Fugit quibusdam quod perferendis expedita pariatur quia.":"Sapiente aut odio laudantium ut et nulla.","Voluptatem corrupti voluptas.":"Qui delectus."},"type":"USER"}]},"root":{"type":"string","description":"The ID of the requested starting node.","example":"USER:u_123"},"truncated":{"type":"boolean","description":"Indicates if the result was clipped by performance budgets.","example":false},"version":{"type":"string","description":"Format version of the response.","example":"1.0"}},"example":{"edges":[{"directed":true,"from":"USER:u_123","id":"e123","manual":false,"to":"MERCHANT:m_777","type":"PAYMENT"},{"directed":true,"from":"USER:u_123","id":"e123","manual":false,"to":"MERCHANT:m_777","type":"PAYMENT"},{"directed":true,"from":"USER:u_123","id":"e123","manual":false,"to":"MERCHANT:m_777","type":"PAYMENT"},{"directed":true,"from":"USER:u_123","id":"e123","manual":false,"to":"MERCHANT:m_777","type":"PAYMENT"}],"nodes":[{"id":"USER:u_123","key":"u_123","label":"User u_123","props":{"Fugit quibusdam quod perferendis expedita pariatur quia.":"Sapiente aut odio laudantium ut et nulla.","Voluptatem corrupti voluptas.":"Qui delectus."},"type":"USER"},{"id":"USER:u_123","key":"u_123","label":"User u_123","props":{"Fugit quibusdam quod perferendis expedita pariatur quia.":"Sapiente aut odio laudantium ut et nulla.","Voluptatem corrupti voluptas.":"Qui delectus."},"type":"USER"},{"id":"USER:u_123","key":"u_123","label":"User u_123","props":{"Fugit quibusdam quod perferendis expedita pariatur quia.":"Sapiente aut odio laudantium ut et nulla.","Voluptatem corrupti voluptas.":"Qui delectus."},"type":"USER"},{"id":"USER:u_123","key":"u_123","label":"User u_123","props":{"Fugit quibusdam quod perferendis expedita pariatur quia.":"Sapiente aut odio laudantium ut et nulla.","Voluptatem corrupti voluptas.":"Qui delectus."},"type":"USER"}],"root":"USER:u_123","truncated":false,"version":"1.0"},"required":["version","root","nodes","edges","truncated"]}}}
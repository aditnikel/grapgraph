// Code generated by goa v3.24.1, DO NOT EDIT.
//
// graph service
//
// Command:
// $ goa gen github.com/aditnikel/grapgraph/design

package graph

import (
	"context"
)

// Graph traversal service for fraud pattern analysis and subgraph extraction.
type Service interface {
	// Returns valid node types, edge types, and supported ranking metrics.
	GetMetadata(context.Context) (res *MetadataResponse, err error)
	// Extracts a surrounding subgraph for a specific root node using multi-hop
	// analysis.
	PostSubgraph(context.Context, *SubgraphRequest) (res *SubgraphResponse, err error)
}

// APIName is the name of the API as defined in the design.
const APIName = "grapgraph"

// APIVersion is the version of the API as defined in the design.
const APIVersion = "0.0.1"

// ServiceName is the name of the service as defined in the design. This is the
// same value that is set in the endpoint request contexts under the ServiceKey
// key.
const ServiceName = "graph"

// MethodNames lists the service method names as defined in the design. These
// are the same values that are set in the endpoint request contexts under the
// MethodKey key.
var MethodNames = [2]string{"get_metadata", "post_subgraph"}

// A relationship between two entities with aggregated metrics.
type GraphEdge struct {
	// Unique ID for the specific relationship.
	ID string
	// The type of connection (e.g. PAYMENT).
	Type string
	// ID of the source node.
	From string
	// ID of the target node.
	To string
	// Whether the relationship has a specific flow direction.
	Directed bool
	// Statistical snapshots (count, amount, first_seen, etc).
	Metrics map[string]any
}

// A single entity (User, Merchant, Device) in the resulting subgraph.
type GraphNode struct {
	// Stable ID generated for visualization.
	ID string
	// The category of the entity.
	Type string
	// The domain-specific key (e.g. u_123).
	Key string
	// Human-friendly display name.
	Label string
	// Additional key-value properties.
	Props map[string]any
}

// MetadataResponse is the result type of the graph service get_metadata method.
type MetadataResponse struct {
	// All valid entity types.
	NodeTypes []string
	// All valid event types.
	EdgeTypes []string
	// Valid keys for the rank_neighbors_by parameter.
	RankMetrics []string
}

// SubgraphRequest is the payload type of the graph service post_subgraph
// method.
type SubgraphRequest struct {
	// The starting node for the traversal.
	Root *struct {
		// Type of the root node (usually USER).
		Type string
		// The unique key of the root node.
		Key string
	}
	// Number of hops to traverse (1-3).
	Hops int
	// Optional time range to filter relationship metrics.
	TimeWindow *struct {
		// Start of the window (RFC3339).
		From string
		// End of the window (RFC3339).
		To string
	}
	// Filter to only include these relationship types.
	EdgeTypes []string
	// Minimum number of aggregate events to include an edge.
	MinEventCount int
	// Metric used to sort and truncate neighbor nodes.
	RankNeighborsBy string
	// Resource budget for the response.
	Limit *struct {
		// Maximum number of nodes to return.
		MaxNodes int
		// Maximum number of edges to return.
		MaxEdges int
	}
}

// SubgraphResponse is the result type of the graph service post_subgraph
// method.
type SubgraphResponse struct {
	// Format version of the response.
	Version string
	// The ID of the requested starting node.
	Root string
	// List of all entities in the network.
	Nodes []*GraphNode
	// List of all connections found.
	Edges []*GraphEdge
	// Indicates if the result was clipped by performance budgets.
	Truncated bool
}

// Error returned when the traversal parameters or root node are invalid.
type BadRequest string

// Error returns an error description.
func (e BadRequest) Error() string {
	return "Error returned when the traversal parameters or root node are invalid."
}

// ErrorName returns "bad_request".
//
// Deprecated: Use GoaErrorName - https://github.com/goadesign/goa/issues/3105
func (e BadRequest) ErrorName() string {
	return e.GoaErrorName()
}

// GoaErrorName returns "bad_request".
func (e BadRequest) GoaErrorName() string {
	return "bad_request"
}
